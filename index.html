<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>

    <link rel="stylesheet" href="index.css">

    <title>SONGHEEMYUN93</title>
</head>
<body>
    <div class="desktop">
        <div class="desktop_icon right_top">
            <div class="icon_wrapper">
                <a href="#"><img src="gif_files/XlO9.gif" alt=""></a>         
            </div>
            <div class="right_top_title">Click  Me!</div>
        </div>
        <div class="desktop_icon iconMs">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_ms/index_ms.html">
                    <img src="icon_images/ms_image.gif" alt="Microsoft">
                </a>         
            </div>
            <div class="title">Microsoft</div>
        </div>
        <div class="desktop_icon icon29">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_29cm/index.html">
                    <img src="icon_images/sp_29cm.png" alt="29CM">
                </a>         
            </div>
            <div class="title">29CM</div>
        </div>
        <div class="desktop_icon iconCarhartt">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_carhartt/carhartt_index.html">
                    <img src="icon_images/carhartt.png" alt="Carhartt WIP">
                </a>         
            </div>
            <div class="title">Carhartt WIP</div>
        </div>
        <div class="desktop_icon iconEyescream">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_eye/index.html">
                    <img src="icon_images/eyescream.gif" alt="Eyescream">
                </a>         
            </div>
            <div class="title">Eyescream</div>
        </div>
        <div class="desktop_icon iconNaver">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_naver/index.html">
                    <img src="icon_images/naver.png" alt="Naver">
                </a>         
            </div>
            <div class="title">Naver</div>
        </div>
        <div class="desktop_icon iconKakaobank">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_kakaobank/index.html">
                    <img src="icon_images/kakaobank.png" alt="KakaoBank">
                </a>         
            </div>
            <div class="title">KakaoBank</div>
        </div>
        <div class="desktop_icon iconStarwars">
            <div class="icon_wrapper">
                <a href="portfolio/portfolio_starwars/index.html">
                    <img src="icon_images/starwars.png" alt="Starwars">
                </a>         
            </div>
            <div class="title">Starwars</div>
        </div>
        <div class="desktop_icon iconYoutube">
            <div class="icon_wrapper">
                <a href="https://www.youtube.com/watch?v=RwCp5e7y3w0">
                    <img src="icon_images/youtube.png" alt="Youtube">
                </a>         
            </div>
            <div class="title">✨MUSIC✨</div>
        </div>
    </div>

    <!-- taskBar -->
    <div class="taskBar">
        <div class="taskBar_btn">
            <button class="startBtn toggle">
                <img src="windows_images/start.png" alt="">
                <b>start</b>
            </button>
            <div class="taskBar_submenu">
                <div class="taskBar_titleBar">
                    <p>SHM<span style="color:rgb(255, 247, 0)">93</span></p>
                </div>
                <ul class="menu">
                    <li class="menuitem">
                        <img src="win93_images/start.png" alt="">
                        <span>HI</span>
                    </li>
                    <li class="menuitem">
                        <img src="" alt="">
                        <span>How are you?</span>
                    </li>
                    <li class="menuitem">
                        <img src="" alt="">
                        <span>I'm fine.</span>
                    </li>
                    <li class="menuitem">
                        <img src="" alt="">
                        <span>Thank you</span>
                    </li>
                    <li class="menuitem">
                        <img src="" alt="">
                        <span>Bye.</span>
                    </li>
                    <li class="menuitem shutdown">
                        <img src="" alt="">
                        <span>Shutdown</span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="taskBar_divider"></div>
        <div class="task">

        </div>
        <div class="taskBar_divider"></div>
        <div class="taskTray">
            <div class="tray_icon">
                <img src="windows_images/task-scheduler-16x16.png" alt="">
                <img src="windows_images/audio-okay-16x16.png" alt="">
            </div>
            <div class="taskBar_time">
                <div id="clock"></div>
            </div>
        </div>
    </div>

    <!-- 클릭하면 div를 추가하면서 얘가 보이게 만들어야함. -->

    <div class="window off">
        <div class="window_titlebar">
            <img class="icon" src="icon_images/wow2_main_1.png" alt="">
            <div class="window_title_area">
                <span>HI! it's ME...</span>
            </div>
            <button class="window_min_button window_btn"></button>
            <button class="window_max_button window_btn"></button>
            <button class="window_close_button window_btn"></button>
        </div>
        <div class="window_content">
            <div class="window_content_area">
                <div>
                    <img class="window_c_icon" src="win93_images/paint.png" alt=""><span>SONG HEE MYUN</span>
                </div>
                <div>
                    <img class="window_c_icon" src="win93_images/poney.gif" alt=""><span>heemony.github.io</span>
                </div>
                <div>
                    <img class="window_c_icon" src="win93_images/voice.png" alt=""><span>01075530514</span>
                </div>
                <div>
                    <img class="window_c_icon" src="win93_images/mail.png" alt=""><span>noodle9323@naver.com</span>
                </div>
            </div>
        </div>    
    </div>
    <script>
        var desktopBtn = document.querySelector('.desktop');
        var startBtn = document.querySelector('.startBtn');
        var showMenu = document.querySelector('.taskBar_submenu');

        // 릭 캐릭터 누르면 readme 나오고 닫히는거.
        const whoamiBtn = document.querySelector('.right_top');
        const windowModal = document.querySelector('.window');
        const closeBtn = windowModal.querySelector('.window_close_button');
        const minBtn = windowModal.querySelector('.window_min_button');
        const maxBtn = windowModal.querySelector('.window_max_button');
        const taskbar = document.querySelector('.task');

        const openModal = () => {
            windowModal.classList.remove('off');
        }
        const closeModal = () => {
            windowModal.classList.add('off');
            var v = Array.from(taskbar.children);
            if(v.length > 0)
             for(let i = 1; i < v.length; i++){
                   v.remove[i]; 
                }

            // var a = taskbar.getElementsByTagName('.div');
            // if( a.className !== 'window.min'){
            //     taskbar.removeChild('window.min');
            // }
            // windowModal.removeChild('window.min');
           
        }
        //최소화 버튼
        const minModal = () => {
            windowModal.classList.add('min'); //.window.min 붙임 (taskbar css적용)
            taskbar.classList.add('modal'); //taskbar에 클래스 modal붙임 => (position:relative css적용)
            const mClone = windowModal.cloneNode(true);  //클론을 해서 붙인거라서, 이 함수 안에서 최소화된 창 눌렀을 때 클론된 요소를 삭제하려고 했음
            windowModal.classList.add('off'); 
            taskbar.appendChild(mClone);
            
        }
         //최소화 된거 다시 누르면 원상태.
        const min_maxModal = (e) => {
            e.preventDefault();
            if(taskbar.children.length === 0) return; //task에 아무것도 없을 때 누르면 반응없음.
            windowModal.classList.remove('min'); //다시 창 보이게 원상태로. 1/2) 작게된 거 원상태.
            windowModal.classList.remove('off'); //다시 창 보이게 원상태로. 2/2) 안 보이는 거 원상태,
        
        }
    
        //최대화 버튼
        const maxModal = () => {
            console.log('maxBtn 눌림')
            if(windowModal.className === 'window max'){
                windowModal.classList.remove('max');
            } else windowModal.classList.add('max');     
        }

        whoamiBtn.addEventListener('click', openModal);
        closeBtn.addEventListener('click', closeModal);
        minBtn.addEventListener('click', minModal);
        maxBtn.addEventListener('click', maxModal);
        taskbar.addEventListener('click', min_maxModal);





        //taskbar  start버튼 누르면 메뉴 열림.닫힘.
        startBtn.addEventListener('click', function(){
            if(startBtn.className === 'startBtn toggle'){
                startBtn.classList.add('clickbtn');
                showMenu.classList.add('clickbtn');
            }else{
                startBtn.classList.remove('clickbtn');
                showMenu.classList.remove('clickbtn');
            }
        });

        
        document.addEventListener('dblclick', showWin);

        // 더블클릭해서 window 창 열기. 아직 안돼...'ㅅ'..
        function showWin(e){
            e.preventDefault();
            console.log('더블클릭됐어')
            if(e.target.parentNode !== 'desktop_icon') {return};
            
            var newDiv = desktopBtn.createElement('div');
            // console.log(newDiv)
            // newDiv.appendChild('div.window');
            document.body.insertBefore(newDiv, desktopBtn); 
        };

    </script>

    
    <script>
        'use strict';

        setDrag('div.iconMs');
        setDrag('div.icon29');
        setDrag('div.iconCarhartt');
        setDrag('div.iconEyescream');
        setDrag('div.iconNaver');
        setDrag('div.iconStarwars');
        setDrag('div.iconKakaobank');
        setDrag('div.iconYoutube');
        setDrag('.window');

        function setDrag(selector) {
            var startX = 0;
            var startY = 0;
            var delX = 0;
            var delY = 0;
            var offsetX = 0;
            var offsetY = 0;
            var isTouched = false;
            var isClickAllowed = true;
            
            $(selector).on('mousedown touchstart', function(e) {
                e = (e.clientX === undefined) ? e.touches[0] : e;
                startX = e.clientX;
                startY = e.clientY;
                offsetX = $(this).position().left;
                offsetY = $(this).position().top;
                $(selector).addClass('on');
                isTouched = true;
            }).on('click', function(e) {
                if (isClickAllowed === false) {
                    e.preventDefault();
                    isClickAllowed = true;
                }
            });
            
            document.addEventListener('mousemove', move, {passive: false});
            document.addEventListener('touchmove', move, {passive: false});
            
            $(document).on('mouseup touchend', function(e) {
                if (isTouched === true) {
                    $(selector).removeClass('on');
                    isTouched = false;
                }
            });
            
            function move(e) {
                if (isTouched === false) return false;
                e.preventDefault();
                e = (e.clientX === undefined) ? e.touches[0] : e;
                delX = e.clientX - startX;
                delY = e.clientY - startY;
                $(selector).css({'left': (offsetX + delX) + 'px', 'top': (offsetY + delY) + 'px'});
                if (Math.abs(delX) > 10 || Math.abs(delY) > 10) isClickAllowed = false;
            }
        }
    </script>
    <script src="taskBar_time.js"></script>
</body>
</html>